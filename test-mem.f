CR .( uNIT TESTS)
CR .( tEST SUITES:)
CR .( MEM)
CR

VARIABLE EXE
VARIABLE OK
VARIABLE FAIL
VARIABLE STEP

: ISUITE
0 EXE ! 0 OK ! 0 FAIL ! ;
: CHECK0
  DEPTH 0= IF 1 STEP +! THEN ;
: CHECK1
  DEPTH 1 = IF 1 STEP +! THEN ;
: CHECK2
  DEPTH 2 = IF 1 STEP +! THEN ;
: CHECK3
  DEPTH 3 = IF 1 STEP +! THEN ;
: CHECK4
  DEPTH 4 = IF 1 STEP +! THEN ;
: ASSERT
  = IF 1 STEP +! THEN ;
: PROK
  ." ok" CR ;
: PRNOK
  ." fail" CR ;
: RESULT
  = IF 1 OK +! PROK ELSE 1 FAIL +! PRNOK THEN ;
: ICASE
  1 EXE +! 0 STEP ! ;
: STAT
  CR ." eXECUTED " OK @ . ." / " EXE @ .
  ." CASES SUCCESSFULLY" CR ;

: T-!
  ." TESTING ! - "
  ICASE
  1234 49152 CHECK2
  ! CHECK0
  STEP @ 2 RESULT
;

: T-@
  ." TESTING @ - "
  ICASE
  1234 49152 !
  CHECK0
  49152 @
  1234 ASSERT
  CHECK0
  STEP @ 3 RESULT
;

: T-C!
  ." TESTING C! - "
  ICASE
  55 49152 CHECK2
  C! CHECK0
  STEP @ 2 RESULT
;

: T-C@
  ." TESTING C@ - "
  ICASE
  55 49152 C!
  CHECK0
  49152 C@
  55 ASSERT
  CHECK0
  STEP @ 3 RESULT
;

: T-+!
  ." TESTING +! - "
  ICASE
  1234 49152 !
  CHECK0
  10 49152 +!
  CHECK0
  49152 @ 
  1244 ASSERT
  STEP @ 3 RESULT
;

: T-CMOVE
  ." TESTING CMOVE - "
  ICASE
  500 0 DO I DUP 2* 49152 + ! LOOP
  49152 50152 1000 CMOVE
  50152 @
  0 ASSERT
  51150 @
  499 ASSERT
  STEP @ 2 RESULT
;

: T-<CMOVE
  ." TESTING <CMOVE - "
  ICASE
  500 0 DO I DUP 2* 49152 + ! LOOP
  49152 49154 1000 <CMOVE
  49154 @
  0 ASSERT
  50152 @
  499 ASSERT
  STEP @ 2 RESULT
;

: MEM
  CR ISUITE
  T-!
  T-@
  T-C!
  T-C@
  T-+!
  T-CMOVE
  T-<CMOVE
  STAT
;

