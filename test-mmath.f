CR .( LOADING TEST SUITE: MMATH) CR

VARIABLE EXE
VARIABLE OK
VARIABLE FAIL
VARIABLE STEP

: ISUITE
0 EXE ! 0 OK ! 0 FAIL ! ;
: CHECK0
  DEPTH 0= IF 1 STEP +! THEN ;
: CHECK1
  DEPTH 1 = IF 1 STEP +! THEN ;
: CHECK2
  DEPTH 2 = IF 1 STEP +! THEN ;
: CHECK3
  DEPTH 3 = IF 1 STEP +! THEN ;
: CHECK4
  DEPTH 4 = IF 1 STEP +! THEN ;
: ASSERT
  = IF 1 STEP +! THEN ;
: DASSERT
  D= IF 1 STEP +! THEN ;
: PROK
  ." ok" CR ;
: PRNOK
  ." fail" CR ;
: RESULT
  = IF 1 OK +! PROK ELSE 1 FAIL +! PRNOK THEN ;
: ICASE
  1 EXE +! 0 STEP ! ;
: STAT
  CR ." eXECUTED " OK @ . ." / " EXE @ .
  ." CASES SUCCESSFULLY" CR ;

: TUM*
  ." TESTING UM* - "
  ICASE
  49152 100 CHECK2
  UM* 4915200. DASSERT
  CHECK0
  STEP @ 3 RESULT
;

: TM*
  ." TESTING M* - "
  ICASE
  1000 -32768 CHECK2
  M* -32768000. DASSERT
  CHECK0
  STEP @ 3 RESULT
;

: TUM/MOD
  ." TESTING UM/MOD - "
  ICASE
  1879048192. 65535 CHECK3
  UM/MOD 28672 ASSERT 28672 ASSERT
  CHECK0
  STEP @ 4 RESULT
;

: TM/
  ." TESTING M/ - "
  ICASE
  -32000555. 32000 CHECK3
  M/ -1000 ASSERT
  CHECK0
  STEP @ 3 RESULT
;

: TM/MOD
  ." TESTING M/MOD - "
  ICASE
  32000555. -32000 CHECK3
  M/MOD -1000 ASSERT 555 ASSERT
  -32000555. 32000 CHECK3
  M/MOD -1000 ASSERT -555 ASSERT
  CHECK0
  STEP @ 7 RESULT
;

: T*/
  ." TESTING */ - "
  ICASE
  -16000 1000 3000 CHECK3
  */ -5333 ASSERT
  CHECK0
  STEP @ 3 RESULT
;

: T*/MOD
  ." TESTING */MOD - "
  ICASE
  16000 1000 -3000 CHECK3
  */MOD -5333 ASSERT 1000 ASSERT
  CHECK0
  STEP @ 4 RESULT
;


: MMATH
  CR ISUITE
  TUM*
  TM*
  TUM/MOD
  TM/
  TM/MOD
  T*/
  T*/MOD
  STAT
;

