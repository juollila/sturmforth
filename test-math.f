CR .( LOADING TEST SUITE: MATH) CR

VARIABLE EXE
VARIABLE OK
VARIABLE FAIL
VARIABLE STEP

: ISUITE
0 EXE ! 0 OK ! 0 FAIL ! ;
: CHECK0
  DEPTH 0= IF 1 STEP +! THEN ;
: CHECK1
  DEPTH 1 = IF 1 STEP +! THEN ;
: CHECK2
  DEPTH 2 = IF 1 STEP +! THEN ;
: CHECK3
  DEPTH 3 = IF 1 STEP +! THEN ;
: CHECK4
  DEPTH 4 = IF 1 STEP +! THEN ;
: ASSERT
  = IF 1 STEP +! THEN ;
: PROK
  ." ok" CR ;
: PRNOK
  ." fail" CR ;
: RESULT
  = IF 1 OK +! PROK ELSE 1 FAIL +! PRNOK THEN ;
: 3RESULT
  STEP @ 3 RESULT ;
: ICASE
  1 EXE +! 0 STEP ! ;
: STAT
  CR ." eXECUTED " OK @ . ." / " EXE @ .
  ." CASES SUCCESSFULLY" CR ;

: T-+
  ." TESTING + - "
  ICASE
  10000 1024 CHECK2
  + CHECK1
  11024 ASSERT
  3RESULT
;

: T--
  ." TESTING - - "
  ICASE
  32767 1767 CHECK2
  - CHECK1
  31000 ASSERT
  3RESULT
;

: T-1+
  ." TESTING 1+ - "
  ICASE
  CHECK0
  32767 1+ CHECK1
  -32768 ASSERT
  3RESULT
;

: T-2+
  ." TESTING 2+ - "
  ICASE
  CHECK0
  -1000 2+ CHECK1
  -998 ASSERT
  3RESULT
;

: T-1-
  ." TESTING 1- - "
  ICASE
  CHECK0
  0 1- CHECK1
  -1 ASSERT
  3RESULT
;

: T-2-
  ." TESTING 2- - "
  ICASE
  CHECK0
  1 2- CHECK1
  -1 ASSERT
  3RESULT
;

: T-2*
  ." TESTING 2* - "
  ICASE
  CHECK0
  -10000 2* CHECK1
  -20000 ASSERT
  3RESULT
;

: T-2/
  ." TESTING 2/ - "
  ICASE
  CHECK0
  25000 2/ CHECK1
  12500 ASSERT
  3RESULT
;

: T-NEGATE
  ." TESTING NEGATE - "
  ICASE
  32767 CHECK1
  NEGATE CHECK1
  -32767 ASSERT
  3RESULT
;

: T-*
  ." TESTING * - "
  ICASE
  1000 32 CHECK2
  * CHECK1
  32000 ASSERT
  3RESULT
;

: T-/MOD
  ." TESTING /MOD - "
  ICASE
  10000 256 CHECK2
  /MOD CHECK2
  39 ASSERT
  16 ASSERT
  STEP @ 4 RESULT
;

: T-MOD
  ." TESTING MOD - "
  ICASE
  -32768 1000 CHECK2
  MOD CHECK1
  -768 ASSERT
 3RESULT
;

: T-MIN
  ." TESTING MIN - "
  ICASE
  -32768 -32767 CHECK2
  MIN CHECK1
  -32768 ASSERT
  3RESULT
;

: T-MAX
  ." TESTING MAX - "
  ICASE
  -32768 -32767 CHECK2
  MAX CHECK1
  -32767 ASSERT
  3RESULT
;

: T-ABS
  ." TESTING ABS - "
  ICASE
  -32767 CHECK1
  ABS CHECK1
  32767 ASSERT
  3RESULT
;

: T-AND
  ." TESTING AND - "
  ICASE
  32000 10000 CHECK2
  AND CHECK1
  9472 ASSERT
  3RESULT
;

: T-OR
  ." TESTING OR - "
  ICASE
  555 666 CHECK2
  OR CHECK1
  699 ASSERT
  3RESULT
;

: T-XOR
  ." TESTING XOR - "
  ICASE
  5555 6666 CHECK2
  XOR CHECK1
  4025 ASSERT
  3RESULT
;

: MATH
  CR ISUITE
  T-+
  T--
  T-1+
  T-2+
  T-1-
  T-2-
  T-2*
  T-2/
  T-NEGATE
  T-*
  T-/MOD
  T-MOD
  T-MIN
  T-MAX
  T-ABS
  T-AND
  T-OR
  T-XOR
  STAT
;
