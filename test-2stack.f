CR .( LOADING TEST SUITE: 2STACK) CR

VARIABLE EXE
VARIABLE OK
VARIABLE FAIL
VARIABLE STEP

: ISUITE
0 EXE ! 0 OK ! 0 FAIL ! ;
: CHECK0
  DEPTH 0= IF 1 STEP +! THEN ;
: CHECK1
  DEPTH 1 = IF 1 STEP +! THEN ;
: CHECK2
  DEPTH 2 = IF 1 STEP +! THEN ;
: CHECK3
  DEPTH 3 = IF 1 STEP +! THEN ;
: CHECK4
  DEPTH 4 = IF 1 STEP +! THEN ;
: CHECK6
  DEPTH 6 = IF 1 STEP +! THEN ;
: ASSERT
  = IF 1 STEP +! THEN ;
: PROK
  ." ok" CR ;
: PRNOK
  ." fail" CR ;
: RESULT
  = IF 1 OK +! PROK ELSE 1 FAIL +! PRNOK THEN ;
: ICASE
  1 EXE +! 0 STEP ! ;
: STAT
  CR ." eXECUTED " OK @ . ." / " EXE @ .
  ." CASES SUCCESSFULLY" CR ;

: T-2DROP
  ." TESTING 2DROP - "
  ICASE
  CHECK0
  1234 5678 CHECK2
  2DROP CHECK0
  STEP @ 3 RESULT
;

: T-2DUP
  ." TESTING 2DUP - "
  ICASE
  CHECK0
  1234 5678 2DUP CHECK4
  5678 ASSERT 1234 ASSERT
  2DROP
  STEP @ 4 RESULT
;

: T-2OVER
  ." TESTING 2OVER - "
  ICASE
  1234 5678 5555 6666 CHECK4
  2OVER CHECK6
  5678 ASSERT 1234 ASSERT
  STEP @ 4 RESULT
  2DROP 2DROP
;

: T-2ROT
  ." TESTING 2ROT - "
  ICASE
  1234 5678 2222 3333 4444 5555 CHECK6
  2ROT
  5678 ASSERT 1234 ASSERT
  5555 ASSERT 4444 ASSERT
  3333 ASSERT 2222 ASSERT
  STEP @ 7 RESULT
;

: T-2SWAP
  ." TESTING 2SWAP - "
  ICASE
  1234 5678 3333 4444 CHECK4
  2SWAP
  5678 ASSERT 1234 ASSERT
  4444 ASSERT 3333 ASSERT
  STEP @ 5 RESULT
;

: 2STACK
  CR ISUITE
  T-2DROP
  T-2DUP
  T-2OVER
  T-2ROT
  T-2SWAP
  STAT
;
