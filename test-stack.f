CR .( uNIT TESTS)
CR .( tEST SUITES:)
CR .( STACK)
CR

VARIABLE EXE
VARIABLE OK
VARIABLE FAIL
VARIABLE STEP

: ISUITE
0 EXE ! 0 OK ! 0 FAIL ! ;
: CHECK0
  DEPTH 0= IF 1 STEP +! THEN ;
: CHECK1
  DEPTH 1 = IF 1 STEP +! THEN ;
: CHECK2
  DEPTH 2 = IF 1 STEP +! THEN ;
: CHECK3
  DEPTH 3 = IF 1 STEP +! THEN ;
: CHECK4
  DEPTH 4 = IF 1 STEP +! THEN ;
: ASSERT
  = IF 1 STEP +! THEN ;
: PROK
  ." ok" CR ;
: PRNOK
  ." fail" CR ;
: RESULT
  = IF 1 OK +! PROK ELSE 1 FAIL +! PRNOK THEN ;
: ICASE
  1 EXE +! 0 STEP ! ;
: STAT
  CR ." eXECUTED " OK @ . ." / " EXE @ .
  ." CASES SUCCESSFULLY" CR ;

: T-DROP
  ." TESTING DROP - "
  ICASE
  CHECK0
  1234 CHECK1
  DROP CHECK0
  STEP @ 3 RESULT
;

: T-2DROP
  ." TESTING 2DROP - "
  ICASE
  CHECK0
  1234 5678 CHECK2
  2DROP CHECK0
  STEP @ 3 RESULT
;

: T-DUP
  ." TESTING DUP - "
  ICASE
  CHECK0
  1234 DUP CHECK2
  1234 = IF 1 STEP +! THEN
  DROP
  STEP @ 3 RESULT
;

: T-OVER
  ." TESTING OVER - "
  ICASE
  1234 5678 CHECK2
  OVER CHECK3
  1234 ASSERT
  STEP @ 3 RESULT
  2DROP
;

: T-ROT
  ." TESTING ROT - "
  ICASE
  1234 5678 9999 CHECK3
  ROT
  1234 ASSERT
  9999 ASSERT
  5678 ASSERT
  STEP @ 4 RESULT
;

: T-SWAP
  ." TESTING SWAP - "
  ICASE
  1234 5678 SWAP CHECK2
  1234 ASSERT
  5678 ASSERT
  STEP @ 3 RESULT
;

: T-?DUP
  ." TESTING ?DUP - "
  ICASE
  0 ?DUP CHECK1
  1234 ?DUP CHECK3
  1234 ASSERT
  2DROP
  STEP @ 3 RESULT
;

: T-PICK
  ." TESTING PICK - "
  ICASE
  1234 5778 9999 CHECK3
  2 PICK CHECK4
  1234 ASSERT
  2DROP
  DROP
  STEP @ 3 RESULT
;

: T-R
  ." TESTING >R AND R> - "
  ICASE
  1234 CHECK1
  >R CHECK0
  5555 DROP
  R> CHECK1
  1234 ASSERT
  STEP @ 4 RESULT
;

: STACK
  CR ISUITE
  T-DROP
  T-2DROP
  T-DUP
  T-OVER
  T-ROT
  T-SWAP
  T-?DUP
  T-PICK
  T-R
  STAT
;

